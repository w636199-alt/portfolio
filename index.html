<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Portfolio</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms,aspect-ratio"></script>
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
        crossorigin="anonymous"
        referrerpolicy="no-referrer"/>
  <style>
    /* ---------- NAVBAR ---------- */
    nav { transition: transform 0.3s ease; }
    .hamburger span { display: block; height: 2px; width: 24px; background: currentColor; margin: 5px 0; border-radius: 1px; transition: transform 0.4s, opacity 0.4s; }
    .hamburger.open span:nth-child(1) { transform: rotate(45deg) translate(5px,5px); }
    .hamburger.open span:nth-child(2) { opacity: 0; }
    .hamburger.open span:nth-child(3) { transform: rotate(-45deg) translate(5px,-5px); }
    #mobile-menu { max-height: 0; overflow: hidden; transition: max-height 0.5s cubic-bezier(0.4,0,0.2,1); }
    #mobile-menu.open { max-height: 500px; }

    /* ---------- SCROLL TO TOP BUTTON ---------- */
    #scrollToTopBtn { opacity: 0; pointer-events: none; transition: opacity 0.3s ease-in-out; }
    #scrollToTopBtn.show { opacity: 1; pointer-events: auto; }

    /* ---------- PROJECT CARDS ---------- */
    .project-card { transition: transform 0.5s ease, box-shadow 0.5s ease; position: relative; cursor: pointer; background-color: white; border-radius: 1rem; overflow: hidden; max-width: 380px; margin: auto; box-shadow: 0 4px 10px rgba(0,0,0,0.08); }
    .project-card .img-container { width: 100%; aspect-ratio: 16/10; overflow: hidden; border-radius: 1rem 1rem 0 0; }
    .project-card .overlay a, #mobile-projects-container .project-card a { color: #db2777; text-decoration: underline; transition: color 0.3s; }
    .project-card .overlay a:hover, #mobile-projects-container .project-card a:hover { color: #be185d; }
    .project-card:hover { transform: translateY(-12px) scale(1.02) rotateZ(-1deg); box-shadow: 0 20px 40px rgba(0,0,0,0.25); }
    .project-card .img-container img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
    .project-card:hover .img-container img { transform: scale(1.08); }
    .project-card .overlay { font-size: 0.8rem; line-height: 1.3; position: absolute; left: 0; bottom: 0; width: 100%; background: rgba(255,255,255,0.95); padding: 0.8rem; text-align: center; transform: translateY(100%); opacity: 0; transition: transform 0.4s ease, opacity 0.4s ease; border-radius: 1rem; }
    .project-card:hover .overlay { transform: translateY(0); opacity: 1; }

    /* ---------- FADE-IN ON SCROLL ---------- */
    .fade-in { opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
    .fade-in.show { opacity: 1; transform: translateY(0); }

    /* ---------- MODAL ---------- */
    .modal { display: none; position: fixed; z-index: 50; inset: 0; background: rgba(0,0,0,0.7); justify-content: center; align-items: center; backdrop-filter: blur(5px); }
    .modal-content { background: #fff; border-radius: 1rem; max-width: 900px; width: 90%; max-height: 80vh; overflow-y: auto; position: relative; box-shadow: 0 15px 50px rgba(0,0,0,0.3); padding: 2rem 1.5rem 1.5rem 1.5rem; transform: scale(0.8); opacity: 0; transition: transform 0.4s ease, opacity 0.4s ease; }
    .modal.show .modal-content { transform: scale(1); opacity: 1; }
    .modal-close-btn { background-color: #db2777; color: white; font-size: 1.2rem; font-weight: bold; position: absolute; top: 12px; right: 12px; width: 36px; height: 36px; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.2); transition: background-color 0.3s, transform 0.2s; }
    .modal-close-btn:hover { background-color: #be185d; transform: scale(1.1); }
    .modal img { border-radius: 0.75rem; margin-bottom: 1rem; }
    .modal h3 { font-size: 1.5rem; font-weight: 700; color: #e11d48; margin-bottom: 0.5rem; }
    .modal p, .modal .prose { color: #374151; font-size: 0.95rem; line-height: 1.5; }
    #modalProjectDescription a { color: #db2777; text-decoration: underline; transition: color 0.3s; }
    #modalProjectDescription a:hover { color: #be185d; }
  </style>
</head>
<body class="bg-transparent relative overflow-x-hidden text-gray-900">

  <!-- Background Circles -->
  <div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10" id="background-circles"></div>

  <!-- NAVBAR -->
  <nav id="navbar" class="fixed w-full top-0 z-50 bg-white/85 backdrop-blur-md shadow-md">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <div class="text-2xl font-bold text-pink-600">WPSH</div>
      <div class="hidden md:flex space-x-6 items-center text-gray-800 font-medium">
        <a href="#about" class="hover:text-pink-500 transition">About</a>
        <a href="#projects" class="hover:text-pink-500 transition">Projects</a>
        <a href="#contact" class="hover:text-pink-500 transition">Contact</a>
        <a href="#" id="desktop-resume-link" target="_blank"
           class="ml-4 bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600 shadow-sm">Resume</a>
      </div>
      <div class="md:hidden">
        <button id="menu-btn" class="focus:outline-none hamburger"><span></span><span></span><span></span></button>
      </div>
    </div>
    <div id="mobile-menu" class="md:hidden flex flex-col bg-white/85 shadow-md">
      <a href="#about" class="block px-4 py-3 border-b hover:bg-gray-100 transition">About</a>
      <a href="#projects" class="block px-4 py-3 border-b hover:bg-gray-100 transition">Projects</a>
      <a href="#contact" class="block px-4 py-3 border-b hover:bg-gray-100 transition">Contact</a>
      <a href="#" id="mobile-resume-link" target="_blank"
           class="block bg-pink-500 text-white text-center px-4 py-3 hover:bg-pink-600 shadow-sm transition">Resume</a>
    </div>
  </nav>

  <!-- ABOUT -->
  <section id="about" class="min-h-screen flex flex-col justify-center items-center text-center px-6 relative">
    <h1 id="greeting" class="text-4xl md:text-5xl font-bold mb-4">Hello, I'm Win Pyi Shan Htat</h1>
    <p id="about-me-text" class="max-w-2xl text-gray-700 leading-relaxed"></p>
  </section>

  <!-- PROJECTS -->
  <section id="projects" class="py-20 px-6 relative z-10">
    <h2 class="text-3xl font-bold mb-12 text-center">Projects</h2>
    <div id="desktop-projects-container" class="w-full max-w-6xl mx-auto hidden lg:grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10"></div>
    <div id="mobile-projects-container" class="block lg:hidden w-full space-y-10 mt-10"></div>
  </section>

  <!-- MODAL -->
  <div id="projectModal" class="modal">
    <div class="modal-content">
      <span onclick="closeProjectModal()" class="modal-close-btn">&times;</span>
      <img id="modalProjectImage" src="" alt="Project Image" class="w-full h-auto object-cover">
      <h3 id="modalProjectTitle"></h3>
      <p id="modalProjectRole" class="font-semibold text-gray-500 mb-4"></p>
      <div id="modalProjectDescription" class="prose max-w-none"></div>
    </div>
  </div>

  <!-- CONTACT -->
  <section id="contact" class="py-20 px-6 relative max-w-xl mx-auto flex flex-col items-center gap-6">
    <h2 class="text-3xl font-bold text-gray-900">Connect with me</h2>
    <div class="flex gap-6 mt-4">
      <a id="email-link" href="#" class="p-4 bg-white rounded-full transform hover:scale-110 hover:shadow-2xl transition">
        <img src="https://upload.wikimedia.org/wikipedia/commons/7/7e/Gmail_icon_%282020%29.svg" alt="Email" class="w-12 h-12"/>
      </a>
      <a id="github-link" href="#" target="_blank" class="p-4 bg-white rounded-full transform hover:scale-110 hover:shadow-2xl transition">
        <img src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg" alt="GitHub" class="w-12 h-12"/>
      </a>
      <a id="linkedin-link" href="#" target="_blank" class="p-4 bg-white rounded-full transform hover:scale-110 hover:shadow-2xl transition">
        <img src="https://upload.wikimedia.org/wikipedia/commons/c/ca/LinkedIn_logo_initials.png" alt="LinkedIn" class="w-12 h-12"/>
      </a>
    </div>
  </section>

  <button id="scrollToTopBtn" class="fixed bottom-5 right-5 z-50 w-12 h-12 bg-pink-500 text-white rounded-full flex justify-center items-center shadow-lg hover:bg-pink-600">
    <i class="fas fa-arrow-up"></i>
  </button>

  <footer class="py-6 text-center text-gray-600 bg-transparent relative">© 2025 WPSH. All rights reserved.</footer>

  <!-- FIREBASE + SCRIPTS -->
  <script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBsrXwcDBvaSOZct9DiYpZHzoIdFyV4NJc",
  authDomain: "wpsh-portfolio.firebaseapp.com",
  projectId: "wpsh-portfolio",
  storageBucket: "wpsh-portfolio.appspot.com",
  messagingSenderId: "654096898034",
  appId: "1:654096898034:web:277a6d479cac10897c3d6b",
  measurementId: "G-3CJ68T2L16"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Utility: truncate for cards
function truncateText(text, wordLimit = 20) {
  const tempDiv = document.createElement('div');
  tempDiv.innerHTML = text;
  const plainText = tempDiv.textContent || tempDiv.innerText || "";
  const words = plainText.trim().split(/\s+/);
  if (words.length > wordLimit) {
    return words.slice(0, wordLimit).join(' ') + '… <span class="text-pink-600 font-semibold block mt-2">See more</span>';
  }
  return text;
}

// Modal open/close
window.openProjectModal = function (image, title, role, description) {
  document.getElementById("modalProjectImage").src = image;
  document.getElementById("modalProjectTitle").textContent = title;
  document.getElementById("modalProjectRole").textContent = role;
  document.getElementById("modalProjectDescription").innerHTML = description;
  const modal = document.getElementById("projectModal");
  modal.style.display = "flex";
  setTimeout(() => modal.classList.add('show'), 10);
};
window.closeProjectModal = function () {
  const modal = document.getElementById("projectModal");
  modal.classList.remove('show');
  setTimeout(() => (modal.style.display = "none"), 400);
};
document.getElementById("projectModal").addEventListener("click", e => {
  if (e.target.id === "projectModal") closeProjectModal();
});

// ---------- FIRESTORE DATA ----------
const portfolioDocRef = doc(db, "portfolio", "main");
onSnapshot(portfolioDocRef, (docSnap) => {
  if (!docSnap.exists()) return console.error("Portfolio data not found!");
  const data = docSnap.data();

  // About
  if (data.about) document.getElementById("about-me-text").textContent = data.about;

  // Resume (use gitUrl if available)
  if (data.resume) {
    const resumeDesktop = document.getElementById("desktop-resume-link");
    const resumeMobile = document.getElementById("mobile-resume-link");

    // Prefer GitHub raw URL
    const resumeUrl = data.resume.gitUrl || data.resume.localUrl;

    const openResume = () => {
      const viewerUrl = `https://docs.google.com/viewer?url=${encodeURIComponent(resumeUrl)}&embedded=true`;
      window.open(viewerUrl, "_blank");
    };
    if (resumeDesktop) resumeDesktop.onclick = openResume;
    if (resumeMobile) resumeMobile.onclick = openResume;
  }

  // Email
  if (data.email) {
    const emailLink = document.getElementById("email-link");
    if (emailLink) emailLink.onclick = () => { window.location.href = `mailto:${data.email}`; };
  }

  // GitHub
  if (data.github) {
    const githubLink = document.getElementById("github-link");
    if (githubLink) {
      const url = data.github.startsWith("http") ? data.github : `https://${data.github}`;
      githubLink.onclick = () => window.open(url, "_blank");
    }
  }

  // LinkedIn
  if (data.linkedin) {
    const linkedinLink = document.getElementById("linkedin-link");
    if (linkedinLink) {
      const url = data.linkedin.startsWith("http") ? data.linkedin : `https://${data.linkedin}`;
      linkedinLink.onclick = () => window.open(url, "_blank");
    }
  }

  // Projects
  const desktopContainer = document.getElementById("desktop-projects-container");
  const mobileContainer = document.getElementById("mobile-projects-container");
  desktopContainer.innerHTML = "";
  mobileContainer.innerHTML = "";

  if (data.projects && Array.isArray(data.projects)) {
    data.projects.forEach((p, i) => {
      const imgUrl = p.gitUrl || p.img; // prefer GitHub URL

      // Desktop card
      const desktopCard = document.createElement("div");
      desktopCard.className = "relative w-full project-card fade-in";
      desktopCard.style.transitionDelay = `${i * 0.1}s`;
      desktopCard.innerHTML = `
        <div class="img-container"><img src="${imgUrl}" alt="${p.title}"></div>
        <div class="p-4 relative text-center">
          <h3 class="font-bold text-lg text-gray-800">${p.title}</h3>
          <p class="text-gray-500 text-sm mt-1">${p.role}</p>
          <div class="overlay">${truncateText(p.desc)}</div>
        </div>`;
      desktopCard.addEventListener("click", () => openProjectModal(imgUrl, p.title, p.role, p.desc));
      desktopContainer.appendChild(desktopCard);

      // Mobile card
      const mobileCard = document.createElement("div");
      mobileCard.className = "project-card fade-in bg-white rounded-xl shadow-lg overflow-hidden";
      mobileCard.style.transitionDelay = `${i * 0.1}s`;
      mobileCard.innerHTML = `
        <div class="img-container"><img src="${imgUrl}" alt="${p.title}"></div>
        <div class="p-6 text-center">
          <h3 class="text-gray-800 font-bold text-xl">${p.title}</h3>
          <p class="text-gray-500 text-sm mt-1">${p.role}</p>
          <div class="text-gray-600 text-sm mt-4 text-left">${truncateText(p.desc, 100)}</div>
        </div>`;
      mobileCard.addEventListener("click", () => openProjectModal(imgUrl, p.title, p.role, p.desc));
      mobileContainer.appendChild(mobileCard);
    });

    // Fade-in observer
    const observer = new IntersectionObserver((entries, obs) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("show");
          obs.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1 });
    document.querySelectorAll(".fade-in").forEach(el => observer.observe(el));
  }
});

// ---------- NAVBAR, SCROLL ----------
document.addEventListener("DOMContentLoaded", () => {
  const btn = document.getElementById("menu-btn");
  const menu = document.getElementById("mobile-menu");
  btn.addEventListener("click", () => {
    menu.classList.toggle("open");
    btn.classList.toggle("open");
  });

  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener("click", function (e) {
      e.preventDefault();
      document.querySelector(this.getAttribute("href")).scrollIntoView({ behavior: "smooth" });
      menu.classList.remove("open");
      btn.classList.remove("open");
    });
  });

  const scrollTopBtn = document.getElementById("scrollToTopBtn");
  window.addEventListener("scroll", () => {
    if (window.scrollY > 300) scrollTopBtn.classList.add("show");
    else scrollTopBtn.classList.remove("show");
  });
  scrollTopBtn.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));
});

// ---------- BACKGROUND BUBBLES ----------
const container = document.getElementById("background-circles");
const navbar = document.getElementById("navbar");
const circles = Array.from({ length: 15 }, (_, i) => {
  const div = document.createElement("div");
  const size = Math.random() * 120 + 80;
  const top = Math.random() * 100;
  const left = Math.random() * 100;
  const opacity = Math.random() * 0.15 + 0.25;
  const blur = Math.random() * 30 + 15;
  const speed = 0.2 + Math.random() * 0.5;

  Object.assign(div.style, {
    position: "absolute",
    width: `${size}px`,
    height: `${size}px`,
    top: `${top}%`,
    left: `${left}%`,
    backgroundColor: "#f9a8d4",
    borderRadius: "50%",
    opacity,
    filter: `blur(${blur}px)`,
    pointerEvents: "none"
  });

  container.appendChild(div);
  return { el: div, posX: 0, posY: 0, rot: 0, targetX: 0, targetY: 0, targetRot: 0, speed };
});

// Scatter bubbles on click (no return)
document.body.addEventListener("click", (e) => {
  if (navbar.contains(e.target)) return;
  circles.forEach(c => {
    c.targetX = (Math.random() - 0.5) * 200;
    c.targetY = (Math.random() - 0.5) * 200;
    c.targetRot = (Math.random() - 0.5) * 60;
  });
});

// Animate bubbles
function animateBubbles() {
  circles.forEach(c => {
    c.posX += (c.targetX - c.posX) * 0.02;
    c.posY += (c.targetY - c.posY) * 0.02;
    c.rot += (c.targetRot - c.rot) * 0.02;
    c.el.style.transform = `translate(${c.posX}px, ${c.posY}px) rotate(${c.rot}deg)`;
  });
  requestAnimationFrame(animateBubbles);
}
animateBubbles();

// Optional: subtle mouse-follow
document.addEventListener("mousemove", e => {
  const xr = e.clientX / window.innerWidth - 0.5;
  const yr = e.clientY / window.innerHeight - 0.5;
  circles.forEach((c, i) => {
    const mx = xr * 10 * ((i % 3) + 1);
    const my = yr * 10 * ((i % 3) + 1);
    c.el.style.transform = `translate(${c.posX + mx}px, ${c.posY + my}px) rotate(${c.rot}deg)`;
  });
});
</script>
</body>
</html>
